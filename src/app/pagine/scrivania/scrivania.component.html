<div class="p-grid attivita-wrapper position-relative">
  <!-- Left side -->
  <div class="p-col content-left" #leftSide>
    <div class="option-bar">
        <div class="buttons-bar">

            <button [ngClass]="mostraStorico?'d-hidden':'d-flex'" #btn type="button" pButton (click)="menu.toggle($event)" class="clMenu" iconPos="left" label="Apri">
                <img src="assets/images/baseline_dashboard_white_48dp.png" width="24px" alt="Apri">
            </button>
            <p-tieredMenu #menu [model]="alberoMenu" [popup]="true" class="clMenuPosition" (itemClick)="handleItemClick($event)"></p-tieredMenu>

            <button [ngClass]="{'ui-button-secondary': true, 'pr-8':true, 'd-hidden': mostraStorico || urlFirmone === '#', 'd-flex': !mostraStorico}" (click)="handleItemClick(urlFirmone)" type="button" pButton label="Firma">
            </button>

            <button [ngClass]="{'d-hidden': mostraStorico || alberoFirma.length < 2, 'd-flex': !mostraStorico}" class="ui-button-secondary" #btn type="button" pButton (click)="firmaMenu.toggle($event)" label="Firma">
            </button>
            <p-tieredMenu #firmaMenu [model]="alberoFirma" [popup]="true" class="clMenuPosition" (itemClick)="handleItemClick($event)"></p-tieredMenu>

            <!-- PRENDI -->
            <button [ngClass]="mostraStorico?'d-hidden':'d-flex'" class="ui-button-secondary" #btn type="button" pButton (click)="azMenu.toggle($event)" label="Prendi">
            </button>
            <p-tieredMenu #azMenu [model]="aziendeMenu"  [popup]="true" class="clMenuPosition" (itemClick)="handleItemClick($event)"></p-tieredMenu>

            <button type="button" pButton [label]="mostraStorico?'Indietro':'Cronologia'" (click)="mostraStorico=!mostraStorico" iconPos="left" class="ui-button-secondary button-with-icon .button-indietro">
                <img [ngClass]="mostraStorico?'d-inline':'d-hidden'" src="assets/images/outline-arrow_back_ios-24px.svg" width="24px" alt="Apri">
            </button>
        </div>

        <app-dropdown-aziende (aziendaEmitter)="aziendaChanged($event)"></app-dropdown-aziende>
    </div>
    <div class="table-wrapper">
        <div class="table-inner">
            <app-attivita *ngIf="!mostraStorico" (attivitaEmitter)="attivitaClicked($event)"
            (onAttivitaNoteEmitter)="onNoteClick($event)" [idAzienda]="idAzienda" [changeColOrder]="changeColOrder"></app-attivita>
            <app-attivita-fatte *ngIf="mostraStorico" (onAttivitaNoteEmitter)="onNoteClick($event)" [idAzienda]="idAzienda"></app-attivita-fatte>
        </div>
    </div>

  </div>

  <div class="p-offset-7 d-inline-block slider" [ngClass]="mostraStorico || !rightSideVisible ? 'd-hidden' : 'd-flex'" #slider><div></div></div>

  <!-- Right side -->
  <div class="p-md-5 p-sm-12 content-right" [ngClass]="mostraStorico || !rightSideVisible ? 'd-hidden' : 'd-flex'" #rightSide>

    <div class="info-doc-wrapper">
        <div class="div-info-doc">
            <b>{{oggetto}}</b>
        </div>
        <p-accordion [multiple]="true" #accordionDetail>
            <p-accordionTab header="Dettagli documento">
                <div *ngIf="mittente || destinatari || destinatariCC">
                    <ul class="ul-info-doc">
                        <li *ngIf="mittente"><span class="li-description">Da: </span><span class="li-content">{{mittente}}</span></li>
                        <li *ngIf="destinatari"><span class="li-content" [innerHTML]="destinatari"></span></li>
                        <li *ngIf="destinatariCC"><span class="li-content" [innerHTML]="destinatariCC"></span></li>
                    </ul>
                </div>
                <div *ngIf="!(mittente || destinatari || destinatariCC)" class="text-centered">
                    Non sono presenti dettagli da visualizzare.
                </div>
            </p-accordionTab>
            <p-accordionTab [selected]="datiDiFlusso" header="Dati di flusso">
                <div *ngIf="datiDiFlusso" >
                    <ul class="ul-info-doc">
                        <li><span pTooltip="{{datiFlussoTooltip}}" [innerHTML]="datiDiFlusso" class="li-content"></span></li>
                    </ul>
                </div>
                <div *ngIf="!datiDiFlusso" class="text-centered">
                    Non sono presenti dati di flusso da visualizzare.
                </div>
            </p-accordionTab>
        </p-accordion>
        <div class="allegati-dropdown">
            <p-dropdown #allegatiDropDown [options]="allegati" (onChange)="allegatoSelected($event)"></p-dropdown>
            <img *ngIf="!noAnteprima" src="assets/images/fullscreen-symbol.svg" (click)="fullscreen($event)" alt="fullscreen"/>
        </div>
    </div>
    <div class="d-flex flex-grow-1">
        <div class="preview-inner">
            <div class="overlapDiv"></div>
            <iframe *ngIf="!noAnteprima" #anteprima id="anteprima" frameborder="0" allowfullscreen webkitallowfullscreen mozallowfullscreen >
            </iframe>
            <div *ngIf="noAnteprima" class="no-anteprima">Anteprima non disponibile.</div>
        </div>
    </div>
    </div>
</div>

<p-dialog header="Note AttivitÃ " [(visible)]="this.showNote" [modal]="true" [responsive]="true" [width]="350" [minWidth]="200" [minY]="70"
        [maximizable]="true" [baseZIndex]="10000">
        {{ this.noteText }}
</p-dialog>
